{% extends 'base.html' %}

{% block main %}

{% include 'actionbar.html' %}
<script>
var treeview = new Treeview({
    draggable: true,
});
$('#content').append(treeview.html);
treeview.select_handler = (selection) => {
    console.log('select', selection);
}
treeview.dblclick_handler = (path, shift) => {
    console.log('dblclick', path, shift);
};
treeview.drop_handler = (data) => {
    console.log('drop', data);
}

var url = new URL(window.location);
var search = new URLSearchParams();
search.set('action', 'list');
url.search = search;
$.get(url, (data) => {
    treeview.empty();
    $.each(data.paths, (_, path) => {
        treeview.insert(path);
    });

    var treeview2 = treeview.clone({
        collapseable: false,
        collapsed: false,
        draggable: false,
        droppable: true,
        foreign_drop: true,
        only_folders: true,
        root_folder: 'Root',
        select_mode: 'single',
    });
    treeview2.drop_handler = (data) => {
        console.log('drop', data);
    }
    $('#content').append('<hr>');
    $('#content').append(treeview2.html);
});

</script>
{% endblock %}