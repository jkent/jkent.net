{% extends 'base.html' %}

{% block main %}

{% include 'actionbar.html' %}
<script>
let treeview = new Treeview({
    draggable: true,
});
$('#content').append(treeview.html);
treeview.select_handler = (selection) => {
    console.log('treeview', 'select', selection);
}
treeview.dblclick_handler = (path, shift) => {
    console.log('treeview', 'dblclick', path, shift);
};
treeview.drop_handler = (data) => {
    console.log('treeview', 'drop', data);
}

let url = new URL(window.location);
let search = new URLSearchParams();
search.set('action', 'list');
url.search = search;
$.get(url, (data) => {
    treeview.empty();
    $.each(data.paths, (_, path) => {
        treeview.insert(path);
    });

    let treeview2 = treeview.clone({
        collapseable: false,
        collapsed: false,
        draggable: false,
        droppable: true,
        foreign_drop: true,
        only_folders: true,
        root_folder: 'Root',
        select_mode: 'single',
    });
    treeview2.select_handler = (selection) => {
        console.log('treeview2', 'select', selection);
    }
    treeview2.dblclick_handler = (path, shift) => {
        console.log('treeview2', 'dblclick', path, shift);
    };
    treeview2.drop_handler = (data) => {
        console.log('treeview2', 'drop', data);
    }
    $('#content').append('<hr>');
    $('#content').append(treeview2.html);

    let treeview3 = treeview.clone({
        collapseable: true,
        collapsed: true,
        draggable: true,
        droppable: true,
        file_drop: true,
        foreign_drop: true,
        only_folders: false,
        root_folder: 'Root',
        select_mode: 'any',
    });
    treeview3.select_handler = (selection) => {
        console.log('treeview3', 'select', selection);
    }
    treeview3.dblclick_handler = (path, shift) => {
        console.log('treeview3', 'dblclick', path, shift);
    };
    treeview3.drop_handler = (data) => {
        console.log('treeview3', 'drop', data);
    }
    $('#content').append('<hr>');
    $('#content').append(treeview3.html);
});

</script>
{% endblock %}